<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Bible Family Tree — Mobile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <div id="app" class="flex flex-col h-screen">
    <div class="flex justify-around border-b bg-white p-2">
      <button id="tabTree" class="font-bold text-blue-600">Tree</button>
      <button id="tabList" class="font-bold">List</button>
    </div>
    <div id="treeView" class="flex-1 overflow-hidden">
      <!-- Focused Card -->
      <div id="focusedCard" class="p-4"></div>
      <!-- Contemporaries Panel -->
      <div id="contemporariesPanel" class="px-4 pb-4"></div>
      <!-- Controls -->
      <div class="flex justify-around p-2 border-t bg-white">
        <button id="btnParents" class="px-3 py-1 bg-gray-200 rounded disabled:opacity-50">↑ Parents</button>
        <button id="btnChildren" class="px-3 py-1 bg-gray-200 rounded disabled:opacity-50">↓ Children</button>
      </div>
    </div>
    <div id="listView" class="hidden flex-1 overflow-auto p-4"></div>
  </div>
  <script>
    const data = [
      {id: 'adam', name: 'Adam', born: 0, died: 930, desc: 'First man created by God.', children: ['seth']},
      {id: 'seth', name: 'Seth', born: 130, died: 1042, desc: 'Son of Adam and Eve.', children: []},
      {id: 'noah', name: 'Noah', born: 1056, died: 2006, desc: 'Built the ark.', children: []},
    ];

    let currentId = 'adam';

    function renderFocused() {
      const person = data.find(p => p.id === currentId);
      const card = `
        <div class="bg-white rounded-xl p-4 shadow">
          <h2 class="text-lg font-bold">${person.name}</h2>
          <p class="text-sm text-gray-500">${person.born}–${person.died} AM</p>
          <p class="mt-1 text-sm line-clamp-2">${person.desc}</p>
          <span class="mt-2 inline-block px-2 py-1 rounded text-xs ${person.children.length ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-500'}">
            ${person.children.length ? `Has children: ${person.children.length}` : 'No children'}
          </span>
        </div>`;
      document.getElementById('focusedCard').innerHTML = card;
      document.getElementById('btnChildren').disabled = !person.children.length;
      renderContemporaries(person);
    }

    function renderContemporaries(person) {
      const contemporaries = data.filter(p => p.id !== person.id && !(p.died < person.born || p.born > person.died));
      const lifespan = person.died - person.born;
      const items = contemporaries.map(c => {
        const start = Math.max(0, c.born - person.born);
        const end = Math.min(lifespan, c.died - person.born);
        const leftPercent = (start / lifespan) * 100;
        const widthPercent = ((end - start) / lifespan) * 100;
        return `<div class="mb-2">
          <div class="flex justify-between text-xs text-gray-600">
            <span>${c.name}</span>
            <span>${c.born}–${c.died}</span>
          </div>
          <div class="relative h-2 bg-gray-200 rounded">
            <div class="absolute top-0 left-[${leftPercent}%] h-2 bg-blue-500 rounded" style="width:${widthPercent}%;"></div>
          </div>
        </div>`;
      }).join('');
      document.getElementById('contemporariesPanel').innerHTML = `
        <h3 class="text-sm font-semibold mb-2">Contemporaries</h3>
        ${items || '<p class="text-xs text-gray-500">No contemporaries found.</p>'}`;
    }

    document.getElementById('btnChildren').onclick = () => {
      const person = data.find(p => p.id === currentId);
      if (person.children.length) {
        currentId = person.children[0];
        renderFocused();
      }
    };

    document.getElementById('btnParents').onclick = () => {
      // Demo: no parent linking yet
      alert('No parent data linked.');
    };

    document.getElementById('tabTree').onclick = () => {
      document.getElementById('treeView').classList.remove('hidden');
      document.getElementById('listView').classList.add('hidden');
    };

    document.getElementById('tabList').onclick = () => {
      document.getElementById('treeView').classList.add('hidden');
      document.getElementById('listView').classList.remove('hidden');
    };

    function renderList() {
      const listHTML = data.map(p => `<div class="mb-2 p-2 bg-white rounded shadow" onclick="currentId='${p.id}';renderFocused();document.getElementById('tabTree').click();">
        <h3 class="font-bold">${p.name}</h3>
        <p class="text-xs text-gray-500">${p.born}–${p.died} AM</p>
      </div>`).join('');
      document.getElementById('listView').innerHTML = listHTML;
    }

    renderList();
    renderFocused();
  </script>
</body>
</html>
